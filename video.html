<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Face ID</title>
  </head>
  <style>
      body {
        background-image: url("FaceID.jpg");
        background-repeat: no-repeat;
        background-size: cover;
      }
    </style>

  <body>
    <h1 style="text-align: left; color: whitesmoke; font-family: Arial; font-size:46px">Face ID</h1>
   <div style="display: flex; justify-content: center; align-items: center;">
    <video id="camera-stream"></video>
  </div>

<div>
  <button id="start-camera" style="color:white; background-color: green; width: 100px; height: 30px;">Start Camera</button>
  <button id="stop-camera" style="color:white; background-color: red; width: 100px; height: 30px;" disabled>Stop Camera</button>
</div>    
    <script>
      const video = document.getElementById('camera-stream');
      const startCameraBtn = document.getElementById('start-camera');
      const stopCameraBtn = document.getElementById('stop-camera');
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      let timerId = null;
      
      // Start the camera
      function startCamera() {
        // Check if the browser supports the getUserMedia API
        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
          navigator.mediaDevices.getUserMedia({ video: true })
            .then(function(stream) {
              video.srcObject = stream;
              video.play();
              startCameraBtn.disabled = true;
              stopCameraBtn.disabled = false;
              timerId = setInterval(sendFrame, 1000); // send a frame every second
            })
            .catch(function(error) {
              console.error('Error accessing media devices.', error);
            });
        } else {
          console.error('Media devices are not supported.');
        }
      }
      
      // Stop the camera
      function stopCamera() {
        clearInterval(timerId);
        const stream = video.srcObject;
        if (stream) {
          const tracks = stream.getTracks();
          tracks.forEach(function(track) {
            track.stop();
          });
          video.srcObject = null;
          startCameraBtn.disabled = false;
          stopCameraBtn.disabled = true;
        }
      }
      
      // Send a frame to the server
      function sendFrame() {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        canvas.toBlob(function(blob) {
          fetch('http://192.168.1.7:8070', {
            method: 'POST',
            body: blob
          })
            .then(function(response) {
              console.log('Frame sent.');
            })
            .catch(function(error) {
              console.error('Error sending frame.', error);
            });
        }, 'image/jpeg');
      }
      
      // Add event listeners to the buttons
      startCameraBtn.addEventListener('click', startCamera);
      stopCameraBtn.addEventListener('click', stopCamera);
    </script>
  </body>
</html>